<!doctype html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>공지사항</title>
    <link th:href="@{/css/base/nav.css}" rel="stylesheet">
    <link th:href="@{/css/faq/notice.css}" rel="stylesheet">
</head>
<body>
<!-- 배경 이미지 -->
<img th:src="@{/images/main/FAQ.png}" alt="mainpage" class="bg">

<header>
    <nav>
        <span onclick="location.href='/'">WashPlan</span>
        <span>예약</span>
        <span>FAQ</span>
        <span style="color: #FFFF00">마이페이지</span>
        <span onclick="location.href='/login'">로그아웃</span>
    </nav>
</header>

<main>
    <button class="faqBtn" onclick="location.href='/faq'">FAQ</button>
    <button class="noticeBtn" onclick="location.href='/notice'">공지사항</button>

    <div class="nav-header">
        <p class="noNav">번호</p>
        <p class="titleNav">제목</p>
        <p class="dateNav">날짜</p>
    </div>
    <hr>

    <div class="notice-list">
        <div th:each="notice : ${notices}" class="notice-item">
            <span class="notice-no" th:text="${notice.noticeNo}"></span>
            <span class="notice-title" th:text="${notice.noticeTitle}"></span>
            <span class="notice-date" th:text="${#temporals.format(notice.noticeDate, 'yyyy-MM-dd')}"></span>
        </div>
    </div>

    <!-- 공지사항 상세보기 모달 -->
    <div id="noticeDetailModal" class="modal">
        <div class="modal-content">
            <div class="notice-detail">
                <p><strong>제목</strong></p>
                <div id="modalTitle" class="content-box"></div>
                <p><strong>내용</strong></p>
                <div id="modalContent" class="content-box"></div>
                <div class="modal-buttons">
                    <button class="confirm-btn">확인</button>
                </div>
            </div>
        </div>
    </div>

    <script>
    document.addEventListener('DOMContentLoaded', function() {
        const modal = document.getElementById('noticeDetailModal');
        
        // 각 공지사항 클릭 이벤트
        document.querySelectorAll('.notice-item').forEach(item => {
            item.addEventListener('click', async function() {
                const noticeNo = this.querySelector('.notice-no').textContent;
                try {
                    const response = await fetch(`/notice/detail/${noticeNo}`);
                    const data = await response.json();
                    
                    // 모달 내용 업데이트
                    document.getElementById('modalTitle').textContent = data.noticeTitle;
                    document.getElementById('modalContent').textContent = data.noticeContent;
                    
                    // 모달 표시 및 스크롤 막기
                    modal.style.display = 'block';
                    document.body.classList.add('no-scroll');
                } catch (error) {
                    console.error('Error:', error);
                }
            });
        });
        
        // 확인 버튼 클릭 시 모달 닫기
        document.querySelector('.confirm-btn').addEventListener('click', function() {
            modal.style.display = 'none';
            document.body.classList.remove('no-scroll');
        });
    });
    </script>
</main>

<footer>
    <span>📞031-123-4567ㅣ✉️contact@washplan.com</span>
    <span>🚩경기 하남시 미사강변동로 85 힐스테이트 에코 3층</span>
    <span>ⓒ 2024 PPal-AjoㅣAll rights reserved.Designed for your convenience.</span>
</footer>
</body>
</html>