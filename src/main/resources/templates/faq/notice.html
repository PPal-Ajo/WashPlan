<!doctype html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>ê³µì§€ì‚¬í•­</title>
    <link th:href="@{/css/base/nav.css}" rel="stylesheet">
    <link th:href="@{/css/faq/notice.css}" rel="stylesheet">
</head>
<body>
<!-- ë°°ê²½ ì´ë¯¸ì§€ -->
<img th:src="@{/images/main/FAQ.png}" alt="mainpage" class="bg">

<header>
    <nav>
        <span onclick="location.href='/'">WashPlan</span>
        <span onclick="location.href='/reservation'">ì˜ˆì•½</span>
        <span onclick="location.href='/faq'" style="color: #FFFF00">FAQ</span>
        <span onclick="location.href='/mypage'">ë§ˆì´í˜ì´ì§€</span>
        <span onclick="location.href='/login'">ë¡œê·¸ì•„ì›ƒ</span>
    </nav>
</header>

<main>
    <button class="faqBtn" onclick="location.href='/faq'">FAQ</button>
    <button class="noticeBtn" onclick="location.href='/notice'">ê³µì§€ì‚¬í•­</button>

    <div class="nav-header">
        <p class="noNav">ë²ˆí˜¸</p>
        <p class="titleNav">ì œëª©</p>
        <p class="dateNav">ë‚ ì§œ</p>
    </div>
    <hr>

    <div class="notice-list">
        <div th:each="notice : ${notices}" class="notice-item">
            <span class="notice-no" th:text="${notice.noticeNo}"></span>
            <span class="notice-title" th:text="${notice.noticeTitle}"></span>
            <span class="notice-date" th:text="${#temporals.format(notice.noticeDate, 'yyyy-MM-dd')}"></span>
        </div>
    </div>

    <!-- ê³µì§€ì‚¬í•­ ìƒì„¸ë³´ê¸° ëª¨ë‹¬ -->
    <div id="noticeDetailModal" class="modal">
        <div class="modal-content">
            <div class="notice-detail">
                <p><strong>ì œëª©</strong></p>
                <div id="modalTitle" class="content-box"></div>
                <p><strong>ë‚´ìš©</strong></p>
                <div id="modalContent" class="content-box"></div>
                <div class="modal-buttons">
                    <button class="confirm-btn">í™•ì¸</button>
                </div>
            </div>
        </div>
    </div>

    <!-- í˜ì´ì§€ë„¤ì´ì…˜ ì¶”ê°€ -->
    <div id="pagination" class="pagination">
        <button id="prevPage" disabled>â—€ï¸</button>
        <div id="pageNumbers"></div>
        <button id="nextPage" disabled>â–º</button>
    </div>

    <script>
    document.addEventListener('DOMContentLoaded', function() {
        const modal = document.getElementById('noticeDetailModal');
        
        // ê° ê³µì§€ì‚¬í•­ í´ë¦­ ì´ë²¤íŠ¸
        document.querySelectorAll('.notice-item').forEach(item => {
            item.addEventListener('click', async function() {
                const noticeNo = this.querySelector('.notice-no').textContent;
                try {
                    const response = await fetch(`/notice/detail/${noticeNo}`);
                    const data = await response.json();
                    
                    // ëª¨ë‹¬ ë‚´ìš© ì—…ë°ì´íŠ¸
                    document.getElementById('modalTitle').textContent = data.noticeTitle;
                    document.getElementById('modalContent').textContent = data.noticeContent;
                    
                    // ëª¨ë‹¬ í‘œì‹œ ë° ìŠ¤í¬ë¡¤ ë§‰ê¸°
                    modal.style.display = 'block';
                    document.body.classList.add('no-scroll');
                } catch (error) {
                    console.error('Error:', error);
                }
            });
        });
        
        // í™•ì¸ ë²„íŠ¼ í´ë¦­ ì‹œ ëª¨ë‹¬ ë‹«ê¸°
        document.querySelector('.confirm-btn').addEventListener('click', function() {
            modal.style.display = 'none';
            document.body.classList.remove('no-scroll');
        });

        // í˜ì´ì§€ë„¤ì´ì…˜ ê´€ë ¨ ë³€ìˆ˜
        const itemsPerPage = 13; // í˜ì´ì§€ë‹¹ ë³´ì—¬ì¤„ í•­ëª© ìˆ˜
        const noticeItems = document.querySelectorAll('.notice-item');
        const totalPages = Math.ceil(noticeItems.length / itemsPerPage);
        let currentPage = 1;

        // í˜ì´ì§€ ë²ˆí˜¸ ìƒì„±
        function createPageNumbers() {
            const pageNumbers = document.getElementById('pageNumbers');
            pageNumbers.innerHTML = '';
            
            for (let i = 1; i <= totalPages; i++) {
                const button = document.createElement('button');
                button.className = `page-number ${i === currentPage ? 'active' : ''}`;
                button.textContent = i;
                button.onclick = () => goToPage(i);
                pageNumbers.appendChild(button);
            }
        }

        // í˜ì´ì§€ ì´ë™
        function goToPage(page) {
            currentPage = page;
            updateDisplay();
            updateButtons();
            createPageNumbers();
        }

        // í™”ë©´ ì—…ë°ì´íŠ¸
        function updateDisplay() {
            const start = (currentPage - 1) * itemsPerPage;
            const end = start + itemsPerPage;

            noticeItems.forEach((item, index) => {
                item.style.display = (index >= start && index < end) ? '' : 'none';
            });
        }

        // ë²„íŠ¼ ìƒíƒœ ì—…ë°ì´íŠ¸
        function updateButtons() {
            document.getElementById('prevPage').disabled = currentPage === 1;
            document.getElementById('nextPage').disabled = currentPage === totalPages;
        }

        // ì´ì „/ë‹¤ìŒ ë²„íŠ¼ ì´ë²¤íŠ¸
        document.getElementById('prevPage').onclick = () => {
            if (currentPage > 1) goToPage(currentPage - 1);
        };

        document.getElementById('nextPage').onclick = () => {
            if (currentPage < totalPages) goToPage(currentPage + 1);
        };

        // ì´ˆê¸° ì„¤ì •
        createPageNumbers();
        updateDisplay();
        updateButtons();
    });
    </script>

    <!-- ë¬¸ì˜í•˜ê¸° ì„¹ì…˜ ì¶”ê°€ -->
    <p class="p1">ë„ì›€ë§ì„ í†µí•´ ë¬¸ì œë¥¼ í•´ê²°í•˜ì§€ ëª»í•˜ì…¨ë‚˜ìš”?</p>

    <div class="DivIq">
        <img th:src="@{/images/main/iq.png}" alt="AImage" class="Iq">
        <p class="IqP1">ë¬¸ì˜í•˜ê¸°<br>
            <br>
            ë§ˆì´í˜ì´ì§€ì—ì„œ ë‹µë³€ì„ ë°›ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
    </div>
</main>

<footer>
    <span>ğŸ“031-123-4567ã…£âœ‰ï¸contact@washplan.com</span>
    <span>ğŸš©ê²½ê¸° í•˜ë‚¨ì‹œ ë¯¸ì‚¬ê°•ë³€ë™ë¡œ 85 íìŠ¤í…Œì´íŠ¸ ì—ì½” 3ì¸µ</span>
    <span>â“’ 2024 PPal-Ajoã…£All rights reserved.Designed for your convenience.</span>
</footer>
</body>
</html>